# Проект на django. Internet shop technique CLA

## 1. Описание проекта

Магазин комплектующих товаров для компьютера. Данный сайт был выполнен в целях обучения и имитирует работу реального сайта. Покупка товаров отсутствует, она имитируется путем отправки специального сообщения на почту покупателя от имени магазина (почты супперпользователя). Сайт был выполнен в рамках поставленного ТЗ.

## 2. Используемый стек технологий

1. Python 3.8
2. Django 4.1
3. Postgresql - БД
4. Clowmail - локальный почтовый сервис

## 3. Установка проекта

Для установки проекта необходимо выполнить ряд действий.

1. Клонировать проект в удобное место

    ```
    git clone https://github.com/zalmon74/CLA__internet_shop_technique.git
    ```

2. Создать виртуальное окружение Python в удобном для вас месте (предворительно в него переместившись)

    ```
    python3.8 -m venv env
    ```

3. Активировать виртуальное окружение

    ```
    source ./env/bin/activate
    ```

4. Установить необходимые зависимости для проекта. Если нет нужды в DEBUG функциях сайта, то необходимо предворительно в проекте убрать все зависимости, связанные с модулем `DEBUG_TOOLBAR`

    C DEBUG функциями сайта:

    ```
    pip install -r 'path_to_clone_project'/CLA__internet_shop_technique/requirements/debug.txt
    ```

    Без DEBUG функций сайта:

    ```
    pip install -r 'path_to_clone_project'/CLA__internet_shop_technique/requirements/base.txt
    ```

5. После установки пакетов в файле `'path_to_env'/env/lib/python3.8/site-packages/admin_numeric_filter/forms.py` заменить import функции `ugettext_lazy` на `gettext_lazy` - это связано с использованием новой Django 4.1
   
6. В корне клонированного проекта `'path_to_clone_project'/CLA__internet_shop_technique/` необходимо создать файл с "секретными данными" с именем `.env` и добавить в него настроечные данные, которые требуют конфиденциальности. Файл содержит настройки подключения к БД: `NAME_BD`, `NAME_USER_BD`, `PASSWORD_USER_BD`, настройки подключения к почтовому сервису: `EMAIL_HOST`, `EMAIL_HOST_USER`, `EMAIL_HOST_PASSWORD`. Данный функционал реализуется благодаря модулю `python-dotenv`. Описание полей приведены ниже в таблице:

| Имя настроечного параметра | Имя необходимое задать в файле .env |                          Комментарии                           |
|:--------------------------:|:-----------------------------------:|:--------------------------------------------------------------:|
|         SECRET_KEY         |             SECRET_KEY              |   Ключевой параметр для защиты отправляемых данных на сервер   |
|      DATABESES: NAME       |               NAME_BD               | Имя базы данных в postgresql, которое использует данный проект |
|      DATABESES: USER       |            NAME_USER_BD             |       Имя пользователя для подключение к БД в postgresql       |
|    DATABASES: PASSWORD     |          PASSWORD_USER_BD           |            Пароль пользователя для подключения к БД            |
| EMAIL_HOST | EMAIL_HOST | Домен для подключения почтового сервера |
| EMAIL_HOST_USER | EMAIL_HOST_USER | Email для пользователя, с которого будет производится отправка сообщений от имени сайта |
| EMAIL_HOST_PASSWORD | EMAIL_HOST_PASSWORD | Пароль для пользователя, с которого будет производится отправка сообщений от имени сайта |

7. Необходимо выполнить миграции (необходимо находиться в каталоге, где расположен файл `manage.py`)

    ```
    python3.8 manage.py migrate --skip-checks
    ```

8. Выполнить скрипт создания группы с администраторами и наделения их соответствующими правами. Перед выполнением скрипта, необходимо, зайти в него и изменить путь до главного каталога проекта в строке 8 (необходимо, указать полный абсолютный путь до каталога, где находится файл manage.py)
   
    ```
    python3.8 ./CLA__shop/accounts/scripts/add_group_and_permissions.py
    ```

9. Выполнить скрипт для добавления в БД настроечных параметров для работы модуля статистики для администраторов. Перед выполнением скрипта, необходимо, зайти в него и изменить путь до главного каталога проекта в строке 8 (необходимо, указать полный абсолютный путь до каталога, где находится файл manage.py)
    
    ```
    python3.8 ./CLA__shop/shop_products/scripts/add_objects_for_statistics_charts.py
    ```

10. Создать суперпользователя

    ```
    python3.8 ./CLA__shop/manage.py createsuperuser
    ```

11. Скопировать static файлы по соответствующим директориям. Static файлы располагаются в архиве `original_template_site.tag.gz` в каталогах `images`, `css`, `js`. Также необходимо скопировать static файлы для admin-сайта, которые располагаются по пути `'path_to_env'/env/lib/python3.8/site-packages/django/contrib/admin/static/admin`

12. Также необходмо запустить скрипты для наполнения БД (т.к. даже главная страница сайта содержит отображение товаров, если товаров не будет вообще, то страница выдаст 500 ошибку - минимум 5 товаров, а также необходимы добавить основные категории).
    
    Для всех скриптов перед их выполнением, необходимо, зайти в него и изменить путь до главного каталога проекта в строке 8 (13 - для товаров) (необходимо, указать полный абсолютный путь до каталога, где находится файл manage.py). Также перед выполнением скриптов, необходимо разархивировать архив с заготовленными изображениями для товаров `images.tar.gz`. После чего в настройках для скриптов (`./CLA_shop/shop_products/scripts/settings.py`) указать путь до разархивированного каталога с изображениями.
    
    Выполнить скрипт добавления категорий товаров:

    ```
    python3.8 ./CLA__shop/shop_products/scripts/add_categories.py
    ```

    Выполнить скрипт добавления брендов:

    ```
    python3.8 ./CLA__shop/shop_products/scripts/add_brands.py
    ```

    Выполнить скрипт добавления товаров:

    ```
    python3.8 ./CLA__shop/shop_products/scripts/add_products.py
    ```

## 4. Дополнительная информация

1. Структура БД и описание таблиц располагается в каталоге `./databeses_models` 
2. при добавлении новой категории необходимо добавить расширенные параметры для товаров созданной категории (также каждые расширенные параметры должны иметь поле product, которое определяется как OneToOne с моделью товара). В каждой модели расширенной категории должен существовать дандер метод "__str__", который сформирован по принципу "'Блок с характеристиками' для продукта {self.product} категории 'Название добавленной категориии'".  Также необходимо в business_logic в функцию "get_list_specifications_for_category" добавить новый список с названиями новых расширенных параметров для категории. Пример: f'Общие параметры для продукта {self.product} категории "Корпуса"'. Расширенные настройки для одной категории должны находиться в одном модуле.
   